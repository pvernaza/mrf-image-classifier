mrf-image-classifier
====================

Image segmentation and classification based on discriminatively-trained Markov random fields

## Dependencies
* OpenCV
* Boost (reasonably recent version)
* CMake

## Compilation
(Example) From the toplevel source directory:
```
mkdir build
cd build
cmake ..
make
```

## Usage

#### binaryTrainBatch
```
binaryTrainBatch <input dir> <output file> 
```
binaryTrainBatch trains a binary MRF image classifier given a directory of RGB images in PNG format along with corresponding segmentations.
For each PNG file, the directory should contain a corresponding segmentation file with suffix ".seg".
This file should be an OpenCV IplImage of depth IPL_DEPTH_32S and of the same dimensions as the corresponding 
RGB image, with each pixel value corresponding to the integer class label of that pixel (in the binary case, 0 or 1).
The MRF is trained via the subgradient method for a fixed number of iterations, at which point the current
segmentations of the training set are displayed (press any key to advance the image).  After each round of training,
the MRF weights are saved to the output file.

#### binaryEvalBatch
```
binaryEvalBatch <input dir> <input weights>
```
binaryEvalBatch evaluates a trained classifier given a directory of PNG images and a weights file generated by binaryTrainBatch.
Visualized segmentations are stored in the same directory, with files having the suffix '.seg.png'.

#### segmentImages
```
segmentImages <input dir> 
```
segmentImages is a GUI tool to generate training segmentations for binaryTrainBatch, given a directory of PNG files.  Left-click to label a segment with the "1" label, and right-click to label it with the 0 label.
